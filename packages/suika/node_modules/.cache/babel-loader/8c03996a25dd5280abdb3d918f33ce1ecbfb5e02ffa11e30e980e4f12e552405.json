{"ast":null,"code":"import { useRef, useState } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport { isNumber } from '../utils';\nconst dumpIndex = (step, arr) => {\n  let index = step > 0 ? step - 1 // move forward\n  : arr.length + step; // move backward\n  if (index >= arr.length - 1) {\n    index = arr.length - 1;\n  }\n  if (index < 0) {\n    index = 0;\n  }\n  return index;\n};\nconst split = (step, targetArr) => {\n  const index = dumpIndex(step, targetArr);\n  return {\n    _current: targetArr[index],\n    _before: targetArr.slice(0, index),\n    _after: targetArr.slice(index + 1)\n  };\n};\nexport default function useHistoryTravel(initialValue, maxLength = 0) {\n  const [history, setHistory] = useState({\n    present: initialValue,\n    past: [],\n    future: []\n  });\n  const {\n    present,\n    past,\n    future\n  } = history;\n  const initialValueRef = useRef(initialValue);\n  const reset = (...params) => {\n    const _initial = params.length > 0 ? params[0] : initialValueRef.current;\n    initialValueRef.current = _initial;\n    setHistory({\n      present: _initial,\n      future: [],\n      past: []\n    });\n  };\n  const updateValue = val => {\n    const _past = [...past, present];\n    const maxLengthNum = isNumber(maxLength) ? maxLength : Number(maxLength);\n    // maximum number of records exceeded\n    if (maxLengthNum > 0 && _past.length > maxLengthNum) {\n      //delete first\n      _past.splice(0, 1);\n    }\n    setHistory({\n      present: val,\n      future: [],\n      past: _past\n    });\n  };\n  const _forward = (step = 1) => {\n    if (future.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, future);\n    setHistory({\n      past: [...past, present, ..._before],\n      present: _current,\n      future: _after\n    });\n  };\n  const _backward = (step = -1) => {\n    if (past.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, past);\n    setHistory({\n      past: _before,\n      present: _current,\n      future: [..._after, present, ...future]\n    });\n  };\n  const go = step => {\n    const stepNum = isNumber(step) ? step : Number(step);\n    if (stepNum === 0) {\n      return;\n    }\n    if (stepNum > 0) {\n      return _forward(stepNum);\n    }\n    _backward(stepNum);\n  };\n  return {\n    value: present,\n    backLength: past.length,\n    forwardLength: future.length,\n    setValue: useMemoizedFn(updateValue),\n    go: useMemoizedFn(go),\n    back: useMemoizedFn(() => {\n      go(-1);\n    }),\n    forward: useMemoizedFn(() => {\n      go(1);\n    }),\n    reset: useMemoizedFn(reset)\n  };\n}","map":{"version":3,"names":["useRef","useState","useMemoizedFn","isNumber","dumpIndex","step","arr","index","length","split","targetArr","_current","_before","slice","_after","useHistoryTravel","initialValue","maxLength","history","setHistory","present","past","future","initialValueRef","reset","params","_initial","current","updateValue","val","_past","maxLengthNum","Number","splice","_forward","_backward","go","stepNum","value","backLength","forwardLength","setValue","back","forward"],"sources":["/Users/yangdan/zf-workspace/react/suika/node_modules/.pnpm/registry.npmmirror.com+ahooks@3.7.4_react@18.2.0/node_modules/ahooks/es/useHistoryTravel/index.js"],"sourcesContent":["import { useRef, useState } from 'react';\nimport useMemoizedFn from '../useMemoizedFn';\nimport { isNumber } from '../utils';\nconst dumpIndex = (step, arr) => {\n  let index = step > 0 ? step - 1 // move forward\n  : arr.length + step; // move backward\n  if (index >= arr.length - 1) {\n    index = arr.length - 1;\n  }\n  if (index < 0) {\n    index = 0;\n  }\n  return index;\n};\nconst split = (step, targetArr) => {\n  const index = dumpIndex(step, targetArr);\n  return {\n    _current: targetArr[index],\n    _before: targetArr.slice(0, index),\n    _after: targetArr.slice(index + 1)\n  };\n};\nexport default function useHistoryTravel(initialValue, maxLength = 0) {\n  const [history, setHistory] = useState({\n    present: initialValue,\n    past: [],\n    future: []\n  });\n  const {\n    present,\n    past,\n    future\n  } = history;\n  const initialValueRef = useRef(initialValue);\n  const reset = (...params) => {\n    const _initial = params.length > 0 ? params[0] : initialValueRef.current;\n    initialValueRef.current = _initial;\n    setHistory({\n      present: _initial,\n      future: [],\n      past: []\n    });\n  };\n  const updateValue = val => {\n    const _past = [...past, present];\n    const maxLengthNum = isNumber(maxLength) ? maxLength : Number(maxLength);\n    // maximum number of records exceeded\n    if (maxLengthNum > 0 && _past.length > maxLengthNum) {\n      //delete first\n      _past.splice(0, 1);\n    }\n    setHistory({\n      present: val,\n      future: [],\n      past: _past\n    });\n  };\n  const _forward = (step = 1) => {\n    if (future.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, future);\n    setHistory({\n      past: [...past, present, ..._before],\n      present: _current,\n      future: _after\n    });\n  };\n  const _backward = (step = -1) => {\n    if (past.length === 0) {\n      return;\n    }\n    const {\n      _before,\n      _current,\n      _after\n    } = split(step, past);\n    setHistory({\n      past: _before,\n      present: _current,\n      future: [..._after, present, ...future]\n    });\n  };\n  const go = step => {\n    const stepNum = isNumber(step) ? step : Number(step);\n    if (stepNum === 0) {\n      return;\n    }\n    if (stepNum > 0) {\n      return _forward(stepNum);\n    }\n    _backward(stepNum);\n  };\n  return {\n    value: present,\n    backLength: past.length,\n    forwardLength: future.length,\n    setValue: useMemoizedFn(updateValue),\n    go: useMemoizedFn(go),\n    back: useMemoizedFn(() => {\n      go(-1);\n    }),\n    forward: useMemoizedFn(() => {\n      go(1);\n    }),\n    reset: useMemoizedFn(reset)\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}