{"ast":null,"code":"/**\n * drag canvas\n */\nexport class DragCanvasTool {\n  constructor(editor) {\n    this.editor = editor;\n    this.type = 'dragCanvas';\n    this.hotkey = 'h';\n    this.startPoint = {\n      x: -1,\n      y: -1\n    };\n    this.prevViewport = void 0;\n  }\n  active() {\n    this.editor.setCursor('grab');\n  }\n  inactive() {\n    this.editor.setCursor('');\n  }\n  moveExcludeDrag() {\n    // do nothing;\n  }\n  start(e) {\n    this.editor.canvasElement.style.cursor = 'grabbing';\n    this.startPoint = this.editor.getCursorXY(e);\n    this.prevViewport = this.editor.viewportManager.getViewport();\n  }\n  drag(e) {\n    const point = this.editor.getCursorXY(e);\n    const startPoint = this.startPoint;\n    const dx = point.x - startPoint.x;\n    const dy = point.y - startPoint.y;\n    const zoom = this.editor.zoomManager.getZoom();\n    // 类似苹果笔记本触控板的 “自然滚动”，所以他要反向，即加上 \"-dx\"\n    const viewportX = this.prevViewport.x - dx / zoom;\n    const viewportY = this.prevViewport.y - dy / zoom;\n    this.editor.viewportManager.setViewport({\n      x: viewportX,\n      y: viewportY\n    });\n    this.editor.sceneGraph.render();\n  }\n  end() {\n    // do nothing\n  }\n  afterEnd() {\n    this.editor.canvasElement.style.cursor = 'grab';\n  }\n}\nDragCanvasTool.type = 'dragCanvas';","map":{"version":3,"names":["DragCanvasTool","constructor","editor","type","hotkey","startPoint","x","y","prevViewport","active","setCursor","inactive","moveExcludeDrag","start","e","canvasElement","style","cursor","getCursorXY","viewportManager","getViewport","drag","point","dx","dy","zoom","zoomManager","getZoom","viewportX","viewportY","setViewport","sceneGraph","render","end","afterEnd"],"sources":["/Users/yangdan/zf-workspace/react/suika/packages/suika/src/editor/tools/tool_drag_canvas.ts"],"sourcesContent":["import { IBox, IPoint } from '../../type';\nimport { Editor } from '../editor';\nimport { ITool } from './type';\n\n/**\n * drag canvas\n */\nexport class DragCanvasTool implements ITool {\n  static type = 'dragCanvas';\n  readonly type = 'dragCanvas';\n  readonly hotkey = 'h';\n  private startPoint: IPoint = { x: -1, y: -1 };\n  private prevViewport!: IBox;\n\n  constructor(private editor: Editor) {}\n  active() {\n    this.editor.setCursor('grab');\n  }\n  inactive() {\n    this.editor.setCursor('');\n  }\n  moveExcludeDrag() {\n    // do nothing;\n  }\n  start(e: PointerEvent) {\n    this.editor.canvasElement.style.cursor = 'grabbing';\n    this.startPoint = this.editor.getCursorXY(e);\n    this.prevViewport = this.editor.viewportManager.getViewport();\n  }\n  drag(e: PointerEvent) {\n    const point: IPoint = this.editor.getCursorXY(e);\n    const startPoint = this.startPoint;\n    const dx = point.x - startPoint.x;\n    const dy = point.y - startPoint.y;\n    const zoom = this.editor.zoomManager.getZoom();\n    // 类似苹果笔记本触控板的 “自然滚动”，所以他要反向，即加上 \"-dx\"\n    const viewportX = this.prevViewport.x - dx / zoom;\n    const viewportY = this.prevViewport.y - dy / zoom;\n\n    this.editor.viewportManager.setViewport({ x: viewportX, y: viewportY });\n    this.editor.sceneGraph.render();\n  }\n  end() {\n    // do nothing\n  }\n  afterEnd() {\n    this.editor.canvasElement.style.cursor = 'grab';\n  }\n}\n"],"mappings":"AAIA;AACA;AACA;AACA,OAAO,MAAMA,cAAc,CAAkB;EAO3CC,WAAWA,CAASC,MAAc,EAAE;IAAA,KAAhBA,MAAc,GAAdA,MAAc;IAAA,KALzBC,IAAI,GAAG,YAAY;IAAA,KACnBC,MAAM,GAAG,GAAG;IAAA,KACbC,UAAU,GAAW;MAAEC,CAAC,EAAE,CAAC,CAAC;MAAEC,CAAC,EAAE,CAAC;IAAE,CAAC;IAAA,KACrCC,YAAY;EAEiB;EACrCC,MAAMA,CAAA,EAAG;IACP,IAAI,CAACP,MAAM,CAACQ,SAAS,CAAC,MAAM,CAAC;EAC/B;EACAC,QAAQA,CAAA,EAAG;IACT,IAAI,CAACT,MAAM,CAACQ,SAAS,CAAC,EAAE,CAAC;EAC3B;EACAE,eAAeA,CAAA,EAAG;IAChB;EAAA;EAEFC,KAAKA,CAACC,CAAe,EAAE;IACrB,IAAI,CAACZ,MAAM,CAACa,aAAa,CAACC,KAAK,CAACC,MAAM,GAAG,UAAU;IACnD,IAAI,CAACZ,UAAU,GAAG,IAAI,CAACH,MAAM,CAACgB,WAAW,CAACJ,CAAC,CAAC;IAC5C,IAAI,CAACN,YAAY,GAAG,IAAI,CAACN,MAAM,CAACiB,eAAe,CAACC,WAAW,CAAC,CAAC;EAC/D;EACAC,IAAIA,CAACP,CAAe,EAAE;IACpB,MAAMQ,KAAa,GAAG,IAAI,CAACpB,MAAM,CAACgB,WAAW,CAACJ,CAAC,CAAC;IAChD,MAAMT,UAAU,GAAG,IAAI,CAACA,UAAU;IAClC,MAAMkB,EAAE,GAAGD,KAAK,CAAChB,CAAC,GAAGD,UAAU,CAACC,CAAC;IACjC,MAAMkB,EAAE,GAAGF,KAAK,CAACf,CAAC,GAAGF,UAAU,CAACE,CAAC;IACjC,MAAMkB,IAAI,GAAG,IAAI,CAACvB,MAAM,CAACwB,WAAW,CAACC,OAAO,CAAC,CAAC;IAC9C;IACA,MAAMC,SAAS,GAAG,IAAI,CAACpB,YAAY,CAACF,CAAC,GAAGiB,EAAE,GAAGE,IAAI;IACjD,MAAMI,SAAS,GAAG,IAAI,CAACrB,YAAY,CAACD,CAAC,GAAGiB,EAAE,GAAGC,IAAI;IAEjD,IAAI,CAACvB,MAAM,CAACiB,eAAe,CAACW,WAAW,CAAC;MAAExB,CAAC,EAAEsB,SAAS;MAAErB,CAAC,EAAEsB;IAAU,CAAC,CAAC;IACvE,IAAI,CAAC3B,MAAM,CAAC6B,UAAU,CAACC,MAAM,CAAC,CAAC;EACjC;EACAC,GAAGA,CAAA,EAAG;IACJ;EAAA;EAEFC,QAAQA,CAAA,EAAG;IACT,IAAI,CAAChC,MAAM,CAACa,aAAa,CAACC,KAAK,CAACC,MAAM,GAAG,MAAM;EACjD;AACF;AAzCajB,cAAc,CAClBG,IAAI,GAAG,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}