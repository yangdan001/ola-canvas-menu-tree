{"ast":null,"code":"import { useRef } from 'react';\nimport useUpdateEffect from '../../../useUpdateEffect';\n// support refreshDeps & ready\nconst useAutoRunPlugin = (fetchInstance, {\n  manual,\n  ready = true,\n  defaultParams = [],\n  refreshDeps = [],\n  refreshDepsAction\n}) => {\n  const hasAutoRun = useRef(false);\n  hasAutoRun.current = false;\n  useUpdateEffect(() => {\n    if (!manual && ready) {\n      hasAutoRun.current = true;\n      fetchInstance.run(...defaultParams);\n    }\n  }, [ready]);\n  useUpdateEffect(() => {\n    if (hasAutoRun.current) {\n      return;\n    }\n    if (!manual) {\n      hasAutoRun.current = true;\n      if (refreshDepsAction) {\n        refreshDepsAction();\n      } else {\n        fetchInstance.refresh();\n      }\n    }\n  }, [...refreshDeps]);\n  return {\n    onBefore: () => {\n      if (!ready) {\n        return {\n          stopNow: true\n        };\n      }\n    }\n  };\n};\nuseAutoRunPlugin.onInit = ({\n  ready = true,\n  manual\n}) => {\n  return {\n    loading: !manual && ready\n  };\n};\nexport default useAutoRunPlugin;","map":{"version":3,"names":["useRef","useUpdateEffect","useAutoRunPlugin","fetchInstance","manual","ready","defaultParams","refreshDeps","refreshDepsAction","hasAutoRun","current","run","refresh","onBefore","stopNow","onInit","loading"],"sources":["/Users/yangdan/zf-workspace/react/suika/node_modules/.pnpm/registry.npmmirror.com+ahooks@3.7.4_react@18.2.0/node_modules/ahooks/es/useRequest/src/plugins/useAutoRunPlugin.js"],"sourcesContent":["import { useRef } from 'react';\nimport useUpdateEffect from '../../../useUpdateEffect';\n// support refreshDeps & ready\nconst useAutoRunPlugin = (fetchInstance, {\n  manual,\n  ready = true,\n  defaultParams = [],\n  refreshDeps = [],\n  refreshDepsAction\n}) => {\n  const hasAutoRun = useRef(false);\n  hasAutoRun.current = false;\n  useUpdateEffect(() => {\n    if (!manual && ready) {\n      hasAutoRun.current = true;\n      fetchInstance.run(...defaultParams);\n    }\n  }, [ready]);\n  useUpdateEffect(() => {\n    if (hasAutoRun.current) {\n      return;\n    }\n    if (!manual) {\n      hasAutoRun.current = true;\n      if (refreshDepsAction) {\n        refreshDepsAction();\n      } else {\n        fetchInstance.refresh();\n      }\n    }\n  }, [...refreshDeps]);\n  return {\n    onBefore: () => {\n      if (!ready) {\n        return {\n          stopNow: true\n        };\n      }\n    }\n  };\n};\nuseAutoRunPlugin.onInit = ({\n  ready = true,\n  manual\n}) => {\n  return {\n    loading: !manual && ready\n  };\n};\nexport default useAutoRunPlugin;"],"mappings":"AAAA,SAASA,MAAM,QAAQ,OAAO;AAC9B,OAAOC,eAAe,MAAM,0BAA0B;AACtD;AACA,MAAMC,gBAAgB,GAAGA,CAACC,aAAa,EAAE;EACvCC,MAAM;EACNC,KAAK,GAAG,IAAI;EACZC,aAAa,GAAG,EAAE;EAClBC,WAAW,GAAG,EAAE;EAChBC;AACF,CAAC,KAAK;EACJ,MAAMC,UAAU,GAAGT,MAAM,CAAC,KAAK,CAAC;EAChCS,UAAU,CAACC,OAAO,GAAG,KAAK;EAC1BT,eAAe,CAAC,MAAM;IACpB,IAAI,CAACG,MAAM,IAAIC,KAAK,EAAE;MACpBI,UAAU,CAACC,OAAO,GAAG,IAAI;MACzBP,aAAa,CAACQ,GAAG,CAAC,GAAGL,aAAa,CAAC;IACrC;EACF,CAAC,EAAE,CAACD,KAAK,CAAC,CAAC;EACXJ,eAAe,CAAC,MAAM;IACpB,IAAIQ,UAAU,CAACC,OAAO,EAAE;MACtB;IACF;IACA,IAAI,CAACN,MAAM,EAAE;MACXK,UAAU,CAACC,OAAO,GAAG,IAAI;MACzB,IAAIF,iBAAiB,EAAE;QACrBA,iBAAiB,CAAC,CAAC;MACrB,CAAC,MAAM;QACLL,aAAa,CAACS,OAAO,CAAC,CAAC;MACzB;IACF;EACF,CAAC,EAAE,CAAC,GAAGL,WAAW,CAAC,CAAC;EACpB,OAAO;IACLM,QAAQ,EAAEA,CAAA,KAAM;MACd,IAAI,CAACR,KAAK,EAAE;QACV,OAAO;UACLS,OAAO,EAAE;QACX,CAAC;MACH;IACF;EACF,CAAC;AACH,CAAC;AACDZ,gBAAgB,CAACa,MAAM,GAAG,CAAC;EACzBV,KAAK,GAAG,IAAI;EACZD;AACF,CAAC,KAAK;EACJ,OAAO;IACLY,OAAO,EAAE,CAACZ,MAAM,IAAIC;EACtB,CAAC;AACH,CAAC;AACD,eAAeH,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}