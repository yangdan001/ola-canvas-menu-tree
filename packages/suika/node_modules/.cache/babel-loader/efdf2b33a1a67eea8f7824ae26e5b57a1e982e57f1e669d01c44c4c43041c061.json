{"ast":null,"code":"var _jsxFileName = \"/Users/yangdan/zf-workspace/react/suika/packages/suika/src/components/Editor.tsx\",\n  _s = $RefreshSig$();\nimport throttle from 'lodash.throttle';\nimport { useEffect, useRef, useState } from 'react';\nimport { EditorContext } from '../context';\nimport { Editor as GraphEditor } from '../editor/editor';\nimport { Header } from './Header';\nimport { InfoPanel } from './InfoPanel';\nimport { LayerPanel } from './LayerPanel';\nimport './Editor.scss';\nimport { ContextMenu } from './ContextMenu';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst topMargin = 48;\nconst leftRightMargin = 240 * 2;\nconst Editor = () => {\n  _s();\n  const containerRef = useRef(null);\n  const [editor, setEditor] = useState(null);\n  useEffect(() => {\n    if (containerRef.current) {\n      const editor = new GraphEditor({\n        containerElement: containerRef.current,\n        width: document.body.clientWidth - leftRightMargin,\n        height: document.body.clientHeight - topMargin,\n        offsetY: 48,\n        offsetX: 240\n      });\n      window.editor = editor;\n      const changeViewport = throttle(() => {\n        editor.viewportManager.setViewport({\n          width: document.body.clientWidth - leftRightMargin,\n          height: document.body.clientHeight - topMargin\n        });\n        editor.sceneGraph.render();\n      }, 150, {\n        leading: false\n      });\n      window.addEventListener('resize', changeViewport);\n      setEditor(editor);\n      return () => {\n        editor.destroy(); // 注销事件\n        window.removeEventListener('resize', changeViewport);\n        changeViewport.cancel();\n      };\n    }\n  }, [containerRef]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(EditorContext.Provider, {\n      value: editor,\n      children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"body\",\n        children: [/*#__PURE__*/_jsxDEV(LayerPanel, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: containerRef,\n          style: {\n            position: 'absolute',\n            left: 240,\n            top: 0\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(InfoPanel, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ContextMenu, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n};\n_s(Editor, \"80UpOQ7N3K5XoP+qf8IkR6wE5dE=\");\n_c = Editor;\nexport default Editor;\nvar _c;\n$RefreshReg$(_c, \"Editor\");","map":{"version":3,"names":["throttle","useEffect","useRef","useState","EditorContext","Editor","GraphEditor","Header","InfoPanel","LayerPanel","ContextMenu","jsxDEV","_jsxDEV","topMargin","leftRightMargin","_s","containerRef","editor","setEditor","current","containerElement","width","document","body","clientWidth","height","clientHeight","offsetY","offsetX","window","changeViewport","viewportManager","setViewport","sceneGraph","render","leading","addEventListener","destroy","removeEventListener","cancel","children","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","className","ref","style","position","left","top","_c","$RefreshReg$"],"sources":["/Users/yangdan/zf-workspace/react/suika/packages/suika/src/components/Editor.tsx"],"sourcesContent":["import throttle from 'lodash.throttle';\nimport { FC, useEffect, useRef, useState } from 'react';\nimport { EditorContext } from '../context';\nimport { Editor as GraphEditor } from '../editor/editor';\nimport { Header } from './Header';\nimport { InfoPanel } from './InfoPanel';\nimport { LayerPanel } from './LayerPanel';\nimport './Editor.scss';\nimport { ContextMenu } from './ContextMenu';\n\nconst topMargin = 48;\nconst leftRightMargin = 240 * 2;\n\nconst Editor: FC = () => {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const [editor, setEditor] = useState<GraphEditor | null>(null);\n\n  useEffect(() => {\n    if (containerRef.current) {\n      const editor = new GraphEditor({\n        containerElement: containerRef.current,\n        width: document.body.clientWidth - leftRightMargin,\n        height: document.body.clientHeight - topMargin,\n        offsetY: 48,\n        offsetX: 240,\n      });\n      (window as any).editor = editor;\n\n      const changeViewport = throttle(\n        () => {\n          editor.viewportManager.setViewport({\n            width: document.body.clientWidth - leftRightMargin,\n            height: document.body.clientHeight - topMargin,\n          });\n          editor.sceneGraph.render();\n        },\n        150,\n        { leading: false },\n      );\n      window.addEventListener('resize', changeViewport);\n      setEditor(editor);\n\n      return () => {\n        editor.destroy(); // 注销事件\n        window.removeEventListener('resize', changeViewport);\n        changeViewport.cancel();\n      };\n    }\n  }, [containerRef]);\n\n  return (\n    <div>\n      <EditorContext.Provider value={editor}>\n        <Header />\n        {/* body */}\n        <div className=\"body\">\n          {/* 目录树组建 */}\n          <LayerPanel />\n          <div\n            ref={containerRef}\n            style={{ position: 'absolute', left: 240, top: 0 }}\n          />\n          <InfoPanel />\n          <ContextMenu />\n        </div>\n      </EditorContext.Provider>\n    </div>\n  );\n};\n\nexport default Editor;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}